# Tangle Tree Visualization Experiment

## Overview

The Tangle Tree experiment implements a hierarchical visualization component that shows complex many-to-many relationships between different levels of data. This is particularly useful for visualizing green growth value chains where supply chains, clusters, and products have interconnected relationships.

## Components

### TangleTree Component (`TangleTree.tsx`)

A React component that implements the tangle layout algorithm originally developed for Observable notebooks. Key features:

- **Hierarchical Layout**: Displays data in levels (Supply Chains → Clusters → Products)
- **Many-to-Many Relationships**: Shows how items can belong to multiple parents
- **Interactive Rendering**: Built with D3.js and SVG for smooth interactions
- **TypeScript Support**: Fully typed for better development experience

#### Props

```typescript
interface TangleTreeProps {
  data: TangleNodeInput[][]; // Array of levels, each containing nodes
  width?: number; // SVG width (default: 1200)
  height?: string; // Container height (default: "600px")
  title?: string; // Visualization title
}
```

#### Data Format

```typescript
interface TangleNodeInput {
  id: string; // Unique identifier
  displaytext?: string; // Display name (falls back to id)
  parents?: string[]; // Array of parent node IDs
}
```

### Experimental Page (`index.tsx`)

An interactive interface for exploring different cluster groups:

- **Group Selection**: Dropdown to choose from 5 cluster groups
- **Real-time Loading**: Fetches group data from `/group_data/` directory
- **Responsive Layout**: Material-UI components for consistent styling
- **Error Handling**: Graceful handling of loading states and errors

## Usage

### Accessing the Experiment

Navigate to `/experimental` in your browser to access the tangle tree visualization.

### Data Sources

The experiment uses group data files generated by the `generateTangledTreeData.js` script:

- `group_0_metals_materials.json` - Metals & Materials cluster group
- `group_1_chemicals_compounds.json` - Chemicals & Compounds cluster group
- `group_2_electrical_power_systems.json` - Electrical & Power Systems cluster group
- `group_3_industrial_components.json` - Industrial Components cluster group
- `group_4_advanced_materials_technologies.json` - Advanced Materials & Technologies cluster group

### Understanding the Visualization

1. **Levels**: Each vertical column represents a level in the hierarchy
2. **Nodes**: Vertical lines represent individual items (supply chains, clusters, products)
3. **Connections**: Curved paths show relationships between levels
4. **Colors**: Different colors distinguish between connection bundles
5. **Labels**: Text labels identify each node

## Technical Implementation

### Algorithm

The tangle layout algorithm:

1. **Preprocessing**: Converts string-based parent references to object references
2. **Bundle Creation**: Groups connections that share the same set of parents
3. **Layout Calculation**: Positions nodes and bundles to minimize visual overlap
4. **Rendering**: Uses D3.js to create SVG paths and elements

### Performance Considerations

- **Data Cloning**: Deep clones input data to avoid mutations
- **Efficient Bundling**: Groups similar connections to reduce visual complexity
- **SVG Optimization**: Uses efficient SVG paths for smooth rendering

## Development

### Adding New Group Data

1. Update the `groupOptions` array in `index.tsx`
2. Place the new JSON file in the `/public/group_data/` directory
3. Ensure the data follows the expected hierarchical format

### Customizing the Layout

The layout can be customized by modifying constants in the `constructTangleLayout` function:

```typescript
const padding = 8; // Space around the visualization
const node_height = 22; // Height of each node
const node_width = 120; // Width allocated for each level
const bundle_width = 50; // Space for connection bundles
const metro_d = 4; // Spacing between bundle connections
```

## Future Enhancements

- **Interactive Selection**: Click nodes to highlight connections
- **Filtering**: Filter by specific clusters or supply chains
- **Export**: Save visualizations as PNG/SVG
- **Animation**: Smooth transitions between different datasets
- **Zoom/Pan**: Navigate large datasets more easily
